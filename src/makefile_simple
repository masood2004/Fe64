# ============================================
#        FE64 CHESS ENGINE - MAKEFILE
# ============================================

# Compiler
CC = gcc

# Standard flags
CFLAGS = -std=c11 -Wall -Wextra

# Release flags (optimized)
RELEASE_FLAGS = -O3 -DNDEBUG -flto

# Debug flags
DEBUG_FLAGS = -g -O0

# Libraries
LIBS = -lpthread -lm

# Output directory
BIN_DIR = ../bin

# Output executable
TARGET = $(BIN_DIR)/fe64

# Source file
SOURCE = bbc.c

# ============================================
#          BUILD TARGETS
# ============================================

.PHONY: all release debug clean

# Default target
all: release

# Release build (optimized)
release: CFLAGS += $(RELEASE_FLAGS)
release: $(TARGET)

# Fast build (maximum optimization)
fast: CFLAGS += -O3 -DNDEBUG -flto -march=native -funroll-loops
fast: $(TARGET)

# Debug build
debug: CFLAGS += $(DEBUG_FLAGS)
debug: $(TARGET)

# Link
$(TARGET): $(SOURCE)
	@mkdir -p $(BIN_DIR)
	$(CC) $(CFLAGS) -o $@ $< $(LIBS)
	@echo "Built $(TARGET) successfully!"

# Clean
clean:
	rm -f $(TARGET)
	rm -f $(TARGET).exe
	@echo "Cleaned build artifacts"

# Windows build (cross-compile)
win64: CC = x86_64-w64-mingw32-gcc
win64: CFLAGS += $(RELEASE_FLAGS) -static
win64: TARGET = $(BIN_DIR)/fe64.exe
win64: $(TARGET)
